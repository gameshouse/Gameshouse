<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Tic Tac Toe - Premium Edition</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Canvas Confetti for celebrations -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary-color: #5468FF;
            --primary-light: #E0E5FF;
            --primary-dark: #3A4DB4;
            --shadow-color: rgba(84, 104, 255, 0.4);
            --border-radius: 12px;
        }

        /* Theme Color Variables */
        .theme-blue {
            --primary-color: #5468FF;
            --primary-light: #E0E5FF;
            --primary-dark: #3A4DB4;
            --shadow-color: rgba(84, 104, 255, 0.4);
        }

        .theme-purple {
            --primary-color: #7B2CBF;
            --primary-light: #EADCF8;
            --primary-dark: #581D8A;
            --shadow-color: rgba(123, 44, 191, 0.4);
        }

        .theme-teal {
            --primary-color: #2A9D8F;
            --primary-light: #D9F0ED;
            --primary-dark: #1D6E65;
            --shadow-color: rgba(42, 157, 143, 0.4);
        }

        .theme-dark {
            --primary-color: #293241;
            --primary-light: #D9DCE1;
            --primary-dark: #1B222D;
            --shadow-color: rgba(41, 50, 65, 0.4);
        }

        .theme-orange {
            --primary-color: #FF9F1C;
            --primary-light: #FFEFD6;
            --primary-dark: #CC7F16;
            --shadow-color: rgba(255, 159, 28, 0.4);
        }

        .theme-red {
            --primary-color: #FF5C5C;
            --primary-light: #FFE5E5;
            --primary-dark: #CC4949;
            --shadow-color: rgba(255, 92, 92, 0.4);
        }

        /* General Styles */
        body {
            background-color: #f5f7ff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
        }

        .container {
            max-width: 1200px;
            width: 100%;
        }

        h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
            font-weight: 800;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin-bottom: 1rem;
            transition: color 0.3s ease;
        }

        /* Ad Container Styles */
        .ad-container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 15px auto;
            overflow: hidden;
        }

        .top-ad {
            max-width: 728px;
            height: 90px;
            background-color: #f0f3ff;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            text-align: center;
            border: 1px dashed #ccc;
        }

        .bottom-ad {
            max-width: 970px;
            height: 250px;
            background-color: #f0f3ff;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            text-align: center;
            border: 1px dashed #ccc;
        }

        /* Rectangle Ad */
        .rectangle-ad {
            width: 300px;
            height: 250px;
            background-color: #f0f3ff;
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #999;
            text-align: center;
            border: 1px dashed #ccc;
            margin: 10px auto 0;
            max-width: 100%;
            box-sizing: border-box;
        }

        @media (max-width: 768px) {
            .top-ad {
                max-width: 100%;
                height: 70px;
            }
            
            .bottom-ad {
                max-width: 100%;
                height: 180px;
            }
        }

        /* Settings Cards - MUCH SMALLER */
        .settings-card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            padding: 6px;
            transition: box-shadow 0.3s ease;
            height: 100%;
        }

        .settings-title {
            font-size: 0.75rem;
            color: var(--primary-color);
            margin-bottom: 0.3rem;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        /* Theme Options - MUCH SMALLER */
        .theme-option {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.2s ease, border 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .theme-option:hover {
            transform: scale(1.1);
        }

        .theme-option.selected {
            border-color: var(--primary-color);
            transform: scale(1.1);
        }

        .theme-blue-bg { background-color: #5468FF; }
        .theme-purple-bg { background-color: #7B2CBF; }
        .theme-teal-bg { background-color: #2A9D8F; }
        .theme-dark-bg { background-color: #293241; }
        .theme-orange-bg { background-color: #FF9F1C; }
        .theme-red-bg { background-color: #FF5C5C; }

        /* Button Options - MUCH SMALLER */
        .button-option {
            padding: 3px 5px;
            border-radius: var(--border-radius);
            border: 1px solid #E0E5FF;
            background-color: white;
            color: #333;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.65rem;
            flex: 1;
            text-align: center;
            min-width: 40px;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }

        .button-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }

        .button-option.selected {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            box-shadow: 0 3px 8px var(--shadow-color);
        }

        .button-option.locked {
            background-color: #e0e0e0;
            color: #999;
            cursor: not-allowed;
            opacity: 0.8;
            position: relative;
        }

        .button-option.locked::after {
            content: 'ðŸ”’';
            position: absolute;
            top: 0;
            right: 2px;
            font-size: 0.6rem;
        }

        /* Icon Options - MUCH SMALLER */
        .icon-option {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid transparent;
            background-color: #f0f3ff;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .icon-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }

        .icon-option.selected {
            border-color: var(--primary-color);
            background-color: var(--primary-light);
            box-shadow: 0 3px 8px var(--shadow-color);
        }

        .icon-option img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        /* Game Board */
        .game-container {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            width: 100%;
        }

        .game-board-wrapper {
            flex: 1;
            min-width: 300px;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .game-status {
            font-size: 1.25rem;
            color: var(--primary-color);
            text-align: center;
            min-height: 2rem;
            margin-bottom: 0.75rem;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            margin: 0 auto;
            width: 100%;
            max-width: 450px;
            aspect-ratio: 1/1;
        }

        .game-board.size-4 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 8px;
        }

        .game-board.size-5 {
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 6px;
        }

        .cell {
            position: relative;
            aspect-ratio: 1/1;
            background-color: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            
            /* 3D Effect */
            box-shadow: 
                0 6px 12px rgba(0, 0, 0, 0.1),
                0 4px 4px rgba(0, 0, 0, 0.1),
                inset 0 -5px 0 0 rgba(0, 0, 0, 0.1),
                inset 0 5px 0 0 rgba(255, 255, 255, 0.5);
        }

        .cell:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 10px 20px var(--shadow-color),
                0 6px 6px rgba(0, 0, 0, 0.05),
                inset 0 -5px 0 0 rgba(0, 0, 0, 0.1),
                inset 0 5px 0 0 rgba(255, 255, 255, 0.5);
        }

        .cell.filled {
            background-color: var(--primary-light);
            box-shadow: 
                0 6px 12px var(--shadow-color),
                0 4px 4px rgba(0, 0, 0, 0.05),
                inset 0 -5px 0 0 rgba(0, 0, 0, 0.1),
                inset 0 5px 0 0 rgba(255, 255, 255, 0.5);
        }

        .cell img {
            width: 70%;
            height: 70%;
            object-fit: contain;
            transform: translateZ(10px);
            transition: all 0.3s ease;
        }

        .cell.winner {
            background-color: var(--primary-light);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 var(--shadow-color);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(0, 0, 0, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);
            }
        }

        /* Control Buttons */
        .control-btn {
            padding: 8px 15px;
            border-radius: var(--border-radius);
            border: none;
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px var(--shadow-color);
            position: relative;
            overflow: hidden;
            font-size: 0.9rem;
        }

        .control-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: all 0.6s ease;
        }

        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }

        .control-btn:hover::after {
            left: 100%;
        }

        .control-btn.reset {
            background-color: #FF5C5C;
            box-shadow: 0 5px 15px rgba(255, 92, 92, 0.4);
        }

        .control-btn.reset:hover {
            box-shadow: 0 8px 15px rgba(255, 92, 92, 0.4);
        }

        /* Premium Features Section */
        .premium-features {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 320px;
            margin-top: 15px;
            overflow: hidden;
        }

        .premium-title {
            font-size: 1rem;
            color: var(--primary-color);
            margin-bottom: 10px;
            font-weight: bold;
            text-align: center;
        }

        .premium-feature {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px;
            border-radius: var(--border-radius);
            background-color: var(--primary-light);
            margin-bottom: 8px;
        }

        .feature-name {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .feature-status {
            font-size: 0.8rem;
            padding: 3px 6px;
            border-radius: 12px;
            font-weight: 500;
        }

        .feature-locked {
            background-color: #ffecec;
            color: #ff5c5c;
        }

        .feature-unlocked {
            background-color: #e3ffe3;
            color: #28a745;
        }

        .unlock-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.7rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .unlock-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-1px);
        }

        /* Ad Modal */
        .ad-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .ad-modal-content {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 500px;
            text-align: center;
            position: relative;
        }

        .ad-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-weight: bold;
        }

        .ad-message {
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .ad-video-container {
            width: 100%;
            height: 250px;
            background-color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            position: relative;
            border-radius: 8px;
            overflow: hidden;
        }

        .ad-video-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #f0f3ff, #e0e5ff);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #666;
        }

        .ad-controls {
            display: flex;
            justify-content: space-between;
            width: 100%;
        }

        .ad-timer {
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .ad-close-btn {
            padding: 8px 16px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 0 auto;
        }

        .ad-close-btn:hover {
            background-color: var(--primary-dark);
        }

        .ad-close-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .ad-skip-btn {
            position: absolute;
            right: 10px;
            top: 10px;
            background-color: rgba(255, 255, 255, 0.7);
            color: #333;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        /* Winner Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            text-align: center;
            max-width: 350px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            transform: scale(0.9);
            animation: modalIn 0.3s forwards;
            position: relative;
            overflow: hidden;
        }

        .celebration-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .trophy-icon {
            position: absolute;
            width: 40px;
            height: 40px;
            opacity: 0;
            animation: flyIn 1s forwards;
        }

        @keyframes flyIn {
            0% {
                transform: translate(-100px, 50px) rotate(-45deg);
                opacity: 0;
            }
            100% {
                transform: translate(0, 0) rotate(0);
                opacity: 1;
            }
        }

        @keyframes modalIn {
            to {
                transform: scale(1);
            }
        }

        .winner-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 15px;
            animation: bounce 1s infinite alternate;
        }

        @keyframes bounce {
            from {
                transform: translateY(0) scale(1);
            }
            to {
                transform: translateY(-10px) scale(1.1);
            }
        }

        .winner-trophy {
            position: absolute;
            top: -20px;
            right: -20px;
            width: 60px;
            height: 60px;
            transform: rotate(30deg);
            animation: rotateIn 1s forwards;
        }

        @keyframes rotateIn {
            from {
                transform: rotate(60deg) scale(0);
            }
            to {
                transform: rotate(30deg) scale(1);
            }
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--primary-color);
            opacity: 0;
        }

        .winner-message {
            font-size: 24px;
            margin-bottom: 25px;
            color: var(--primary-color);
            font-weight: bold;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
        }

        .win-counter {
            font-size: 16px;
            margin-bottom: 20px;
            color: #666;
        }

        .play-again-btn {
            padding: 10px 25px;
            border-radius: var(--border-radius);
            border: none;
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        .play-again-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px var(--shadow-color);
        }

        /* Stats section */
        .stats-section {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            margin-top: 20px;
            width: 100%;
            max-width: 500px;
        }

        .stats-title {
            font-size: 1rem;
            color: var(--primary-color);
            margin-bottom: 10px;
            font-weight: 600;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .stat-card {
            background-color: var(--primary-light);
            padding: 10px;
            border-radius: var(--border-radius);
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .container {
                padding: 0 15px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 10px;
            }
            
            h1 {
                font-size: 1.8rem;
                margin-bottom: 0.5rem;
            }
            
            .settings-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 5px;
            }
            
            .settings-card {
                padding: 5px;
            }
            
            .settings-title {
                font-size: 0.7rem;
                margin-bottom: 0.2rem;
            }
            
            .button-option {
                padding: 2px 4px;
                font-size: 0.6rem;
            }
            
            .theme-option {
                width: 18px;
                height: 18px;
            }
            
            .icon-option {
                width: 22px;
                height: 22px;
            }
            
            .game-status {
                font-size: 1rem;
                margin-bottom: 0.5rem;
            }
            
            .control-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 576px) {
            .settings-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .cell {
                border-radius: 8px;
            }
            
            .control-buttons {
                flex-direction: column;
                gap: 8px;
            }
            
            .control-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body class="theme-blue">
    <div class="container">
        <header>
            <h1>3D Tic Tac Toe</h1>
        </header>

        <!-- Top Ad Banner - Leaderboard (728Ã—90) -->
        <div class="ad-container">
            <div class="top-ad">
                <div>Advertisement (728Ã—90)</div>
            </div>
        </div>

        <div class="settings-grid grid grid-cols-3 gap-2 mb-3">
            <div class="settings-card">
                <div class="settings-title">Theme</div>
                <div class="flex flex-wrap gap-1">
                    <div class="theme-option theme-blue-bg selected" data-theme="blue"></div>
                    <div class="theme-option theme-purple-bg" data-theme="purple"></div>
                    <div class="theme-option theme-teal-bg" data-theme="teal"></div>
                    <div class="theme-option theme-dark-bg" data-theme="dark"></div>
                    <div class="theme-option theme-orange-bg" data-theme="orange"></div>
                    <div class="theme-option theme-red-bg" data-theme="red"></div>
                </div>
            </div>

            <div class="settings-card">
                <div class="settings-title">Difficulty</div>
                <div class="flex gap-1">
                    <div class="button-option selected" data-difficulty="easy">Easy</div>
                    <div class="button-option" data-difficulty="medium">Med</div>
                    <div class="button-option locked" data-difficulty="hard">Hard</div>
                </div>
            </div>

            <div class="settings-card">
                <div class="settings-title">Game Mode</div>
                <div class="flex gap-1">
                    <div class="button-option" data-mode="computer">Computer</div>
                    <div class="button-option selected" data-mode="player">Player</div>
                </div>
            </div>
        </div>

        <div class="settings-grid grid grid-cols-3 gap-2 mb-3">
            <div class="settings-card">
                <div class="settings-title">Board Size</div>
                <div class="flex gap-1">
                    <div class="button-option selected" data-size="3">3Ã—3</div>
                    <div class="button-option" data-size="4">4Ã—4</div>
                    <div class="button-option locked" data-size="5">5Ã—5</div>
                </div>
            </div>

            <div class="settings-card">
                <div class="settings-title">Player 1 Icon</div>
                <div class="flex flex-wrap gap-1">
                    <div class="icon-option selected" data-icon="robot">
                        <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Robot/3D/robot_3d.png" alt="Robot">
                    </div>
                    <div class="icon-option" data-icon="alien">
                        <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Alien/3D/alien_3d.png" alt="Alien">
                    </div>
                    <div class="icon-option" data-icon="ghost">
                        <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Ghost/3D/ghost_3d.png" alt="Ghost">
                    </div>
                    <div class="icon-option" data-icon="fox">
                        <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Fox/3D/fox_3d.png" alt="Fox">
                    </div>
                    <div class="icon-option" data-icon="panda">
                        <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Panda/3D/panda_3d.png" alt="Panda">
                    </div>
                </div>
            </div>

            <div class="settings-card">
                <div class="settings-title">Player 2 Icon</div>
                <div class="flex flex-wrap gap-1">
                    <div class="icon-option" data-icon="robot">
                        <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Robot/3D/robot_3d.png" alt="Robot">
                    </div>
                    <div class="icon-option selected" data-icon="alien">
                        <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Alien/3D/alien_3d.png" alt="Alien">
                    </div>
                    <div class="icon-option" data-icon="ghost">
                        <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Ghost/3D/ghost_3d.png" alt="Ghost">
                    </div>
                    <div class="icon-option" data-icon="fox">
                        <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Fox/3D/fox_3d.png" alt="Fox">
                    </div>
                    <div class="icon-option" data-icon="panda">
                        <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Panda/3D/panda_3d.png" alt="Panda">
                    </div>
                </div>
            </div>
        </div>

        <div class="game-container">
            <div class="game-board-wrapper">
                <div class="game-status">Player 1's Turn</div>
                <div class="game-board"></div>
                <div class="flex gap-4 mt-4 control-buttons">
                    <button class="control-btn start">Start Game</button>
                    <button class="control-btn reset">Reset Game</button>
                </div>
                
                <div class="stats-section mt-4">
                    <div class="stats-title">Game Statistics</div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="player1-wins">0</div>
                            <div class="stat-label">Player 1 Wins</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="player2-wins">0</div>
                            <div class="stat-label">Player 2 Wins</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="draws">0</div>
                            <div class="stat-label">Draws</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="total-games">0</div>
                            <div class="stat-label">Total Games</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="premium-features">
                <div class="premium-title">Premium Features</div>
                
                <div class="premium-feature">
                    <div class="feature-name">Hard Difficulty</div>
                    <div class="feature-status feature-locked" id="hard-status">Locked</div>
                    <button class="unlock-btn" id="unlock-hard">Watch Ad</button>
                </div>
                
                <div class="premium-feature">
                    <div class="feature-name">5Ã—5 Board Size</div>
                    <div class="feature-status feature-locked" id="size5-status">Locked</div>
                    <button class="unlock-btn" id="unlock-size5">Watch Ad</button>
                </div>
                
                <div class="rectangle-ad mt-4">
                    <div>Advertisement (300Ã—250)</div>
                </div>
            </div>
        </div>
        
        <!-- Bottom Ad Banner - Billboard (970Ã—250) -->
        <div class="ad-container">
            <div class="bottom-ad">
                <div>Advertisement (970Ã—250)</div>
            </div>
        </div>

        <!-- Video Ad Modal -->
        <div class="ad-modal" id="adModal">
            <div class="ad-modal-content">
                <div class="ad-title">Watch Ad to Unlock Premium Feature</div>
                <div class="ad-message" id="adMessage">Watch this short video to unlock Hard difficulty mode!</div>
                
                <div class="ad-video-container">
                    <div class="ad-video-placeholder">
                        <div>ðŸ“º Video Advertisement</div>
                        <div style="font-size: 0.8rem; margin-top: 5px;">Simulated ad for demonstration purposes</div>
                    </div>
                </div>
                
                <div class="ad-timer" id="adTimer">Ad will end in: 5 seconds</div>
                <button class="ad-close-btn" id="adCloseBtn" disabled>Skip Ad (5)</button>
            </div>
        </div>

        <!-- Winner Modal -->
        <div class="modal" id="winnerModal">
            <div class="modal-content">
                <div class="celebration-container" id="celebrationContainer"></div>
                <img src="https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Trophy/3D/trophy_3d.png" alt="Trophy" class="winner-trophy">
                <div class="winner-icon">
                    <img src="" alt="Winner" id="winnerIcon">
                </div>
                <div class="winner-message" id="winnerMessage"></div>
                <div class="win-counter" id="winCounter"></div>
                <button class="play-again-btn">Play Again</button>
            </div>
        </div>

        <!-- Sound Effects -->
        <audio id="clickSound" src="https://cdn.jsdelivr.net/gh/himalayasingh/music-player-1@5bbf3dd95cf2587ac1ac638522cfca2043538507/music/2.mp3" preload="auto"></audio>
        <audio id="winSound" src="https://cdn.jsdelivr.net/gh/himalayasingh/music-player-1@master/music/1.mp3" preload="auto"></audio>
        <audio id="unlockSound" src="https://cdn.jsdelivr.net/gh/himalayasingh/music-player-1@master/music/3.mp3" preload="auto"></audio>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Game variables
            let currentPlayer = 1;
            let gameActive = false;
            let gameMode = 'player';
            let difficulty = 'easy';
            let boardSize = 3;
            let player1Icon = 'robot';
            let player2Icon = 'alien';
            let currentTheme = 'blue';
            let gameBoard = [];
            let winCombinations = [];
            
            // Premium features status
            let hardModeUnlocked = false;
            let size5Unlocked = false;
            
            // Statistics
            let player1Wins = 0;
            let player2Wins = 0;
            let draws = 0;
            let totalGames = 0;

            // Sound effects
            const clickSound = document.getElementById('clickSound');
            const winSound = document.getElementById('winSound');
            const unlockSound = document.getElementById('unlockSound');

            // Function to play click sound
            function playClickSound() {
                clickSound.currentTime = 0;
                clickSound.play().catch(e => console.log("Audio play error:", e));
            }

            // Function to play win sound
            function playWinSound() {
                winSound.currentTime = 0;
                winSound.play().catch(e => console.log("Audio play error:", e));
            }
            
            // Function to play unlock sound
            function playUnlockSound() {
                unlockSound.currentTime = 0;
                unlockSound.play().catch(e => console.log("Audio play error:", e));
            }

            // DOM Elements
            const gameBoardElement = document.querySelector('.game-board');
            const gameStatusElement = document.querySelector('.game-status');
            const startButton = document.querySelector('.control-btn.start');
            const resetButton = document.querySelector('.control-btn.reset');
            const modal = document.getElementById('winnerModal');
            const winnerMessage = document.getElementById('winnerMessage');
            const winnerIcon = document.getElementById('winnerIcon');
            const winCounter = document.getElementById('winCounter');
            const playAgainButton = document.querySelector('.play-again-btn');
            
            // Ad modal elements
            const adModal = document.getElementById('adModal');
            const adMessage = document.getElementById('adMessage');
            const adTimer = document.getElementById('adTimer');
            const adCloseBtn = document.getElementById('adCloseBtn');
            
            // Premium feature buttons
            const unlockHardBtn = document.getElementById('unlock-hard');
            const unlockSize5Btn = document.getElementById('unlock-size5');
            const hardStatus = document.getElementById('hard-status');
            const size5Status = document.getElementById('size5-status');
            
            // Statistics elements
            const player1WinsElement = document.getElementById('player1-wins');
            const player2WinsElement = document.getElementById('player2-wins');
            const drawsElement = document.getElementById('draws');
            const totalGamesElement = document.getElementById('total-games');

            // Function to update statistics display
            function updateStats() {
                player1WinsElement.textContent = player1Wins;
                player2WinsElement.textContent = player2Wins;
                drawsElement.textContent = draws;
                totalGamesElement.textContent = totalGames;
            }

            // Theme options
            const themeOptions = document.querySelectorAll('.theme-option');
            themeOptions.forEach(option => {
                option.addEventListener('click', () => {
                    playClickSound();
                    themeOptions.forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    currentTheme = option.dataset.theme;
                    document.body.className = '';
                    document.body.classList.add(`theme-${currentTheme}`);
                    updateThemeColors();
                });
            });

            // Difficulty options
            const difficultyOptions = document.querySelectorAll('[data-difficulty]');
            difficultyOptions.forEach(option => {
                option.addEventListener('click', () => {
                    // Skip if locked and trying to access hard mode
                    if (option.classList.contains('locked')) {
                        showAdModal('hard');
                        return;
                    }
                    
                    playClickSound();
                    difficultyOptions.forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    difficulty = option.dataset.difficulty;
                });
            });

            // Game mode options
            const modeOptions = document.querySelectorAll('[data-mode]');
            modeOptions.forEach(option => {
                option.addEventListener('click', () => {
                    playClickSound();
                    modeOptions.forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    gameMode = option.dataset.mode;
                });
            });

            // Board size options
            const sizeOptions = document.querySelectorAll('[data-size]');
            sizeOptions.forEach(option => {
                option.addEventListener('click', () => {
                    // Skip if locked and trying to access 5x5 board
                    if (option.classList.contains('locked')) {
                        showAdModal('size5');
                        return;
                    }
                    
                    playClickSound();
                    sizeOptions.forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    boardSize = parseInt(option.dataset.size);
                    if (gameActive) {
                        initializeGame(); // Reinitialize the game when board size changes
                    }
                });
            });

            // Find settings cards by title text
            function findSettingsCardByTitle(titleText) {
                const titles = document.querySelectorAll('.settings-title');
                for (let i = 0; i < titles.length; i++) {
                    if (titles[i].textContent.trim() === titleText) {
                        return titles[i].closest('.settings-card');
                    }
                }
                return null;
            }

            // Player 1 icon options - FIXED HERE
            const player1Card = findSettingsCardByTitle('Player 1 Icon');
            const player1IconOptions = player1Card ? player1Card.querySelectorAll('.icon-option') : [];
            player1IconOptions.forEach(option => {
                option.addEventListener('click', () => {
                    playClickSound();
                    player1IconOptions.forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    player1Icon = option.dataset.icon;
                    if (gameActive) {
                        updateBoardUI(); // Update board to reflect new icons
                    }
                });
            });

            // Player 2 icon options - FIXED HERE
            const player2Card = findSettingsCardByTitle('Player 2 Icon');
            const player2IconOptions = player2Card ? player2Card.querySelectorAll('.icon-option') : [];
            player2IconOptions.forEach(option => {
                option.addEventListener('click', () => {
                    playClickSound();
                    player2IconOptions.forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    player2Icon = option.dataset.icon;
                    if (gameActive) {
                        updateBoardUI(); // Update board to reflect new icons
                    }
                });
            });

            // Start game button
            startButton.addEventListener('click', () => {
                playClickSound();
                initializeGame();
            });

            // Reset game button
            resetButton.addEventListener('click', () => {
                playClickSound();
                initializeGame();
            });

            // Play again button
            playAgainButton.addEventListener('click', () => {
                playClickSound();
                modal.style.display = 'none';
                initializeGame();
            });
            
            // Unlock hard mode button
            unlockHardBtn.addEventListener('click', () => {
                playClickSound();
                showAdModal('hard');
            });
            
            // Unlock 5x5 board button
            unlockSize5Btn.addEventListener('click', () => {
                playClickSound();
                showAdModal('size5');
            });
            
            // Ad close button
            adCloseBtn.addEventListener('click', () => {
                if (!adCloseBtn.disabled) {
                    hideAdModal();
                    const featureType = adModal.dataset.featureType;
                    unlockFeature(featureType);
                }
            });
            
            // Function to show ad modal
            function showAdModal(featureType) {
                adModal.dataset.featureType = featureType;
                
                if (featureType === 'hard') {
                    adMessage.textContent = 'Watch this short video to unlock Hard difficulty mode!';
                } else if (featureType === 'size5') {
                    adMessage.textContent = 'Watch this short video to unlock the 5Ã—5 board size!';
                }
                
                adModal.style.display = 'flex';
                
                // Simulate ad timer
                let secondsLeft = 5;
                adTimer.textContent = `Ad will end in: ${secondsLeft} seconds`;
                adCloseBtn.disabled = true;
                adCloseBtn.textContent = `Skip Ad (${secondsLeft})`;
                
                const timerInterval = setInterval(() => {
                    secondsLeft--;
                    adTimer.textContent = `Ad will end in: ${secondsLeft} seconds`;
                    adCloseBtn.textContent = `Skip Ad (${secondsLeft})`;
                    
                    if (secondsLeft <= 0) {
                        clearInterval(timerInterval);
                        adTimer.textContent = 'You can now close this ad';
                        adCloseBtn.disabled = false;
                        adCloseBtn.textContent = 'Close Ad';
                    }
                }, 1000);
            }
            
            // Function to hide ad modal
            function hideAdModal() {
                adModal.style.display = 'none';
            }
            
            // Function to unlock premium feature
            function unlockFeature(featureType) {
                playUnlockSound();
                
                if (featureType === 'hard') {
                    hardModeUnlocked = true;
                    const hardOption = document.querySelector('[data-difficulty="hard"]');
                    hardOption.classList.remove('locked');
                    hardStatus.textContent = 'Unlocked';
                    hardStatus.classList.remove('feature-locked');
                    hardStatus.classList.add('feature-unlocked');
                    unlockHardBtn.style.display = 'none';
                    
                    // Auto-select hard mode
                    difficultyOptions.forEach(o => o.classList.remove('selected'));
                    hardOption.classList.add('selected');
                    difficulty = 'hard';
                } 
                else if (featureType === 'size5') {
                    size5Unlocked = true;
                    const size5Option = document.querySelector('[data-size="5"]');
                    size5Option.classList.remove('locked');
                    size5Status.textContent = 'Unlocked';
                    size5Status.classList.remove('feature-locked');
                    size5Status.classList.add('feature-unlocked');
                    unlockSize5Btn.style.display = 'none';
                    
                    // Auto-select 5x5 board
                    sizeOptions.forEach(o => o.classList.remove('selected'));
                    size5Option.classList.add('selected');
                    boardSize = 5;
                    
                    if (gameActive) {
                        initializeGame(); // Reinitialize the game when board size changes
                    }
                }
            }

            // Function to update theme colors
            function updateThemeColors() {
                document.documentElement.className = '';
                document.documentElement.classList.add(`theme-${currentTheme}`);
            }

            // Initialize game
            function initializeGame() {
                gameActive = true;
                currentPlayer = 1;
                gameBoard = Array(boardSize).fill().map(() => Array(boardSize).fill(''));
                gameStatusElement.textContent = "Player 1's Turn";
                generateWinningCombinations();
                createGameBoard();
            }

            // Generate winning combinations based on board size
            function generateWinningCombinations() {
                winCombinations = [];
                
                // Rows
                for (let i = 0; i < boardSize; i++) {
                    const row = [];
                    for (let j = 0; j < boardSize; j++) {
                        row.push(i * boardSize + j);
                    }
                    winCombinations.push(row);
                }
                
                // Columns
                for (let i = 0; i < boardSize; i++) {
                    const col = [];
                    for (let j = 0; j < boardSize; j++) {
                        col.push(j * boardSize + i);
                    }
                    winCombinations.push(col);
                }
                
                // Diagonals
                const diag1 = [];
                const diag2 = [];
                for (let i = 0; i < boardSize; i++) {
                    diag1.push(i * boardSize + i);
                    diag2.push(i * boardSize + (boardSize - 1 - i));
                }
                winCombinations.push(diag1);
                winCombinations.push(diag2);
            }

            // Create game board based on selected size
            function createGameBoard() {
                gameBoardElement.innerHTML = '';
                gameBoardElement.className = 'game-board';
                gameBoardElement.classList.add(`size-${boardSize}`);
                
                for (let i = 0; i < boardSize * boardSize; i++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.index = i;
                    
                    cell.addEventListener('click', () => cellClick(cell));
                    gameBoardElement.appendChild(cell);
                }
            }

            // Handle cell click
            function cellClick(cell) {
                if (!gameActive) return;
                
                const index = parseInt(cell.dataset.index);
                const row = Math.floor(index / boardSize);
                const col = index % boardSize;
                
                if (gameBoard[row][col] !== '') return;
                
                playClickSound();
                makeMove(row, col);
                
                if (gameActive && gameMode === 'computer' && currentPlayer === 2) {
                    setTimeout(computerMove, 500);
                }
            }

            // Make a move
            function makeMove(row, col) {
                gameBoard[row][col] = currentPlayer;
                updateBoardUI();
                
                if (checkWin()) {
                    gameActive = false;
                    const winner = currentPlayer;
                    const winnerIconSrc = getPlayerIconSrc(winner);
                    
                    // Update statistics
                    totalGames++;
                    if (winner === 1) {
                        player1Wins++;
                    } else {
                        player2Wins++;
                    }
                    updateStats();
                    
                    // Show celebration
                    playWinSound();
                    winnerIcon.src = winnerIconSrc;
                    winnerMessage.textContent = `Player ${winner} Wins!`;
                    winCounter.textContent = `Wins: ${winner === 1 ? player1Wins : player2Wins}`;
                    modal.style.display = 'flex';
                    
                    // Create confetti celebration
                    createConfetti();
                    return;
                }
                
                if (checkDraw()) {
                    gameActive = false;
                    
                    // Update statistics
                    totalGames++;
                    draws++;
                    updateStats();
                    
                    winnerIcon.src = "https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Handshake/3D/handshake_3d.png";
                    winnerMessage.textContent = "It's a Draw!";
                    winCounter.textContent = `Draws: ${draws}`;
                    modal.style.display = 'flex';
                    return;
                }
                
                currentPlayer = currentPlayer === 1 ? 2 : 1;
                gameStatusElement.textContent = `Player ${currentPlayer}'s Turn`;
            }

            // Create confetti celebration effect
            function createConfetti() {
                confetti({
                    particleCount: 150,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: [
                        '#5468FF', '#E0E5FF', '#3A4DB4', // blue theme
                        '#FFD700', '#FFA500', '#FF4500'  // gold/orange for celebration
                    ]
                });
            }

            // Update the UI to reflect the current game state
            function updateBoardUI() {
                const cells = document.querySelectorAll('.cell');
                for (let i = 0; i < boardSize; i++) {
                    for (let j = 0; j < boardSize; j++) {
                        const index = i * boardSize + j;
                        const cell = cells[index];
                        
                        if (gameBoard[i][j] !== '') {
                            const playerIconSrc = getPlayerIconSrc(gameBoard[i][j]);
                            
                            if (!cell.querySelector('img')) {
                                const img = document.createElement('img');
                                img.src = playerIconSrc;
                                cell.appendChild(img);
                                cell.classList.add('filled');
                            } else {
                                cell.querySelector('img').src = playerIconSrc;
                            }
                        } else {
                            cell.innerHTML = '';
                            cell.classList.remove('filled');
                        }
                    }
                }
            }

            // Get player icon src based on player number
            function getPlayerIconSrc(player) {
                const icon = player === 1 ? player1Icon : player2Icon;
                switch (icon) {
                    case 'robot':
                        return "https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Robot/3D/robot_3d.png";
                    case 'alien':
                        return "https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Alien/3D/alien_3d.png";
                    case 'ghost':
                        return "https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Ghost/3D/ghost_3d.png";
                    case 'fox':
                        return "https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Fox/3D/fox_3d.png";
                    case 'panda':
                        return "https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Panda/3D/panda_3d.png";
                    default:
                        return "https://cdn.jsdelivr.net/gh/microsoft/fluentui-emoji/assets/Alien/3D/alien_3d.png";
                }
            }

            // Check if current player has won
            function checkWin() {
                for (const combination of winCombinations) {
                    const cells = combination.map(index => {
                        const row = Math.floor(index / boardSize);
                        const col = index % boardSize;
                        return gameBoard[row][col];
                    });
                    
                    if (cells.every(cell => cell === currentPlayer)) {
                        highlightWinCombination(combination);
                        return true;
                    }
                }
                return false;
            }

            // Highlight winning combination on the board
            function highlightWinCombination(combination) {
                const cells = document.querySelectorAll('.cell');
                combination.forEach(index => {
                    cells[index].classList.add('winner');
                });
            }

            // Check if the game is a draw
            function checkDraw() {
                return gameBoard.flat().every(cell => cell !== '');
            }

            // Computer move based on difficulty
            function computerMove() {
                if (!gameActive) return;
                
                let row, col;
                
                switch (difficulty) {
                    case 'hard':
                        const move = getBestMove();
                        row = move.row;
                        col = move.col;
                        break;
                    case 'medium':
                        if (Math.random() < 0.6) {
                            const move = getBestMove();
                            row = move.row;
                            col = move.col;
                        } else {
                            const emptySpot = getRandomEmptyCell();
                            row = emptySpot.row;
                            col = emptySpot.col;
                        }
                        break;
                    case 'easy':
                    default:
                        const emptySpot = getRandomEmptyCell();
                        row = emptySpot.row;
                        col = emptySpot.col;
                        break;
                }
                
                playClickSound();
                makeMove(row, col);
            }

            // Get a random empty cell
            function getRandomEmptyCell() {
                const emptyCells = [];
                for (let i = 0; i < boardSize; i++) {
                    for (let j = 0; j < boardSize; j++) {
                        if (gameBoard[i][j] === '') {
                            emptyCells.push({ row: i, col: j });
                        }
                    }
                }
                
                const randomIndex = Math.floor(Math.random() * emptyCells.length);
                return emptyCells[randomIndex];
            }

            // Minimax algorithm for hard AI
            function getBestMove() {
                let bestScore = -Infinity;
                let bestMove = { row: 0, col: 0 };
                
                for (let i = 0; i < boardSize; i++) {
                    for (let j = 0; j < boardSize; j++) {
                        if (gameBoard[i][j] === '') {
                            gameBoard[i][j] = 2; // AI is player 2
                            let score = minimax(gameBoard, 0, false);
                            gameBoard[i][j] = '';
                            
                            if (score > bestScore) {
                                bestScore = score;
                                bestMove = { row: i, col: j };
                            }
                        }
                    }
                }
                
                return bestMove;
            }

            // Minimax helper function
            function minimax(board, depth, isMaximizing) {
                // For simplicity, we'll only use minimax for 3x3 board
                if (boardSize > 3 && depth > 1) {
                    return 0;
                }
                
                // Check terminal states
                if (checkWinForMinimax(board, 2)) return 10 - depth;
                if (checkWinForMinimax(board, 1)) return depth - 10;
                if (isFullBoard(board)) return 0;
                
                if (isMaximizing) {
                    let bestScore = -Infinity;
                    
                    for (let i = 0; i < boardSize; i++) {
                        for (let j = 0; j < boardSize; j++) {
                            if (board[i][j] === '') {
                                board[i][j] = 2;
                                let score = minimax(board, depth + 1, false);
                                board[i][j] = '';
                                bestScore = Math.max(score, bestScore);
                            }
                        }
                    }
                    
                    return bestScore;
                } else {
                    let bestScore = Infinity;
                    
                    for (let i = 0; i < boardSize; i++) {
                        for (let j = 0; j < boardSize; j++) {
                            if (board[i][j] === '') {
                                board[i][j] = 1;
                                let score = minimax(board, depth + 1, true);
                                board[i][j] = '';
                                bestScore = Math.min(score, bestScore);
                            }
                        }
                    }
                    
                    return bestScore;
                }
            }

            // Check win for minimax
            function checkWinForMinimax(board, player) {
                for (const combination of winCombinations) {
                    const cells = combination.map(index => {
                        const row = Math.floor(index / boardSize);
                        const col = index % boardSize;
                        return board[row][col];
                    });
                    
                    if (cells.every(cell => cell === player)) {
                        return true;
                    }
                }
                return false;
            }

            // Check if board is full
            function isFullBoard(board) {
                return board.flat().every(cell => cell !== '');
            }

            // Show interstitial ad after every few games
            function showInterstitialAd() {
                // Only show after every 3 games
                if (totalGames % 3 === 0 && totalGames > 0) {
                    setTimeout(() => {
                        showAdModal('interstitial');
                    }, 500);
                }
            }

            // Initial setup
            updateThemeColors();
            initializeGame();
            updateStats();
        });
    </script>
</body>
</html>
